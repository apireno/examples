
hello
  <style>
        /* You can adjust the container style as needed. */
        #graphContainer {
                position: absolute;
                width: 100%;
                height: 100%;
                background-color: white;
            }

        #graphContainer > svg {
            width: 100%;
            height: 100%;
        }
    </style>

    <style type="text/css" media="screen">
        html, body, svg { width: 100%; height: 100%;}
    </style>
<div id="graphContainer"></div>

    <script>
        the_data = {{ graph_data | tojson }};       

        function renderGraph(graphData) {
            var graphGenerator = Viva.Graph.generator();
            var graph = graphGenerator.grid(3, 3);

            // 1. Add nodes to the graph
            graphData.nodes.forEach(node => {
                graph.addNode(node.id, {
                    label: node.label,
                    type: node.type,
                    source_document: node.source_document,
                    link: "/entity_detail?" + node.id,
                    edge_count: node.edge_count,
                    entity_type:node.entity_type
                });
            });

            // 2. Add edges to the graph
            graphData.edges.forEach(edge => {
                const width = edge.confidence ? mapConfidenceToWidth(edge.confidence) : 1;
                graph.addLink(edge.source, edge.target, {
                    label: edge.label,
                    confidence: edge.confidence,
                    width: width
                });
            });

            var graphics = Viva.Graph.View.svgGraphics();
            graphics.node(function(node){
                console.log(node.data ? node.data["edge_count"] : "nan")
                return Viva.Graph.svg('rect')
                    .attr('width', 10 * (node.data ? node.data.edge_count:1) )
                    .attr('height', 10 * (node.data ? node.data.edge_count:1) )
                    .attr('fill', node.data ? (node.data.entity_type=="company" ? "pink" : "purple") : '#00a2e8');
            });



            var layout = Viva.Graph.Layout.forceDirected(graph, {
                springLength : 10,
                springCoeff : 0.0005,
                dragCoeff : 0.02,
                gravity : -1.2
            });

            
            var container = document.getElementById('graphContainer');

            // specify where it should be rendered:
            var renderer = Viva.Graph.View.renderer(graph, {
                container: container,
                //layout: layout,
                graphics: graphics
                
            });

            renderer.run();




           function mapConfidenceToWidth(confidence) {
                // Map confidence values (assumed to be between 0 and 10) to line widths.
                const minWidth = 1;
                const maxWidth = 5;
                return (confidence / 10) * (maxWidth - minWidth) + minWidth;
            }
        }

        renderGraph(the_data);
    </script>


